# EliteLogs 1.2.1 — Release Notes

## Изменения по сравнению с 1.2
- Структурирован новый API `DisconnectLogEntry`: все обработчики и перехватчики передают единый объект, поэтому любые внешние расширения могут безопасно читать стадии и параметры отключения без парсинга строк.
- `DisconnectListener` переработан с использованием кешируемых рефлексивных вызовов и выносом логики в `DisconnectEventInspector`, что снижает накладные расходы и исключает падения на старых ядрах.
- Протоколловский перехват теперь уважает флаг `logs.disconnects.capture-screen` и записывает как понятный текст, так и исходный JSON причины отключения.
- Команда `/elogs logs` показывает актуальные категории из конфигурации, их состояния и получила новые строки локализации для всех языковых пакетов.
- Переключение `/elogs logs toggle` теперь мгновенно обновляет `LogRouter` без полной перезагрузки плагина.
- Локализации (EN/RU/DE/FR/ES) обновлены: добавлены статусы «включено/выключено» для списка логов.
- HTTP API получил автогенерацию ключа доступа: при пустом `api.auth-token` плагин создаёт стойкое значение и сообщает о нём в логах.
- Добавлена админ-команда `/elogs apikey` (псевдоним `/elogs token`) для просмотра, проверки статуса и перевыпуска API-ключа без правки конфигурации.
- `plugin.yml` и `config.yml` получают версию напрямую из `pom.xml`, благодаря чему итоговый jar, конфиг и документация не расходятся при релизе 1.2.1.

## Изменения по сравнению с 1.1
- Добавлен модуль `/logs/disconnects`, который фиксирует отклонённые pre-login, блокировки на `PlayerLoginEvent`, кики, выходы, статус скачивания ресурспака и (при наличии ProtocolLib) тексты экранов отключения.
- Появилась поддержка ProtocolLib как необязательной зависимости для чтения серверных пакетов DISCONNECT.
- Конфигурация дополнена переключателем категорий (`logs.types.disconnects`) и новым блоком `logs.disconnects.capture-screen` для управления протокольным перехватом.
- Формат логов унифицирован: каждая запись — это `[фаза] ключ=значение`, что упрощает интеграцию со скриптами и SIEM.
- Папки игроков для disconnect-событий создаются автоматически при включенном `split-by-player`.
- Листенер `PlayerKickEvent` больше не фиксирует отменённые кики, чтобы исключить ложные срабатывания.

## Документация и экосистема
- README расширен описанием формата disconnect-логов, новым поведением `/elogs logs` и примером конфигурации с `logs.disconnects.capture-screen`.
- Документация по HTTP API дополнена инструкцией по управлению ключом через `/elogs apikey`, а `config.yml` теперь подсказывает, что ключ генерируется автоматически.
- Добавлен файл `release.md` (этот документ) для публикации релиза 1.2.1.
- README получил полный русский дубль в отдельном `README.ru.md` и детализированный справочник по командам и модулям.

## Совместимость и сборка
- Сборка переведена в много-модульный Maven-проект: перед компиляцией плагина автоматически собирается облегчённый модуль ProtocolLib 5.1.0, поэтому `mvn -DskipTests package` из корня репозитория успешно выполняется даже офлайн. На боевых серверах по-прежнему требуется настоящая ProtocolLib для захвата экранов отключения.
- Поддерживаемый диапазон серверов остаётся 1.8.x – 1.21.x, все рефлексивные вызовы защищены от отсутствующих API.
